# 安装和使用说明

## 🚀 快速开始

### 1. 安装插件

插件已经位于 `Tf_plugins/enhanced-user-import/` 目录中，无需额外安装。

### 2. 启用插件

1. 确保 HydroOJ 服务正在运行
2. 重启 HydroOJ 服务以加载插件
3. 以管理员身份登录系统

### 3. 访问增强版用户导入

有两种方式访问增强版用户导入功能：

**方式一：通过管理控制面板**
1. 进入管理界面 (`/manage`)
2. 在左侧菜单中找到 "Enhanced User Import" 选项
3. 点击进入增强版用户导入页面

**方式二：直接访问链接**
- 直接访问 `/manage/userimport/enhanced`

## 📋 使用步骤

### 1. 准备用户数据

#### 支持的数据格式

**CSV 格式（推荐）**
```csv
email,username,password,displayName,extra
user1@example.com,student1,pass123,张三,"{\"group\":\"students\",\"school\":\"北京大学\"}"
user2@example.com,teacher1,pass456,李老师,"{\"group\":\"teachers\",\"school\":\"清华大学\"}"
```

**TSV 格式**
```tsv
email	username	password	displayName	extra
user1@example.com	student1	pass123	张三	{"group":"students","school":"北京大学"}
user2@example.com	teacher1	pass456	李老师	{"group":"teachers","school":"清华大学"}
```

#### 字段要求

- **email**: 邮箱地址（必填，格式必须正确）
- **username**: 用户名（必填，3-20个字符）
- **password**: 密码（必填，至少6个字符）
- **displayName**: 显示名称（可选）
- **extra**: 额外信息（可选，JSON格式）

### 2. 导入用户

#### 方法一：文件上传
1. 点击 "文件上传" 标签页
2. 将 CSV/TSV 文件拖拽到上传区域，或点击选择文件
3. 系统会自动解析和验证数据

#### 方法二：文本粘贴
1. 点击 "粘贴文本" 标签页
2. 将用户数据粘贴到文本框中
3. 系统会自动验证数据格式

### 3. 数据验证

系统会自动验证以下内容：
- 邮箱格式正确性
- 用户名长度和格式
- 密码强度要求
- 重复数据检测
- JSON 格式验证

### 4. 预览和导入

1. 点击 "预览结果" 查看数据预览
2. 检查统计信息和验证结果
3. 设置批次大小（推荐 50-100）
4. 点击 "立即导入" 开始导入
5. 观察进度条和结果反馈

## 🔧 高级配置

### 批次处理

对于大量用户数据，建议使用批次处理：

- **小型导入** (< 100 用户): 批次大小 50
- **中型导入** (100-1000 用户): 批次大小 100
- **大型导入** (> 1000 用户): 批次大小 50-100

### 用户组管理

通过 `extra` 字段可以设置用户组：

```json
{
  "group": "students",
  "school": "北京大学",
  "studentId": "2023001"
}
```

### 错误处理

如果导入过程中遇到错误：

1. 检查数据格式是否正确
2. 确保邮箱和用户名唯一
3. 验证密码符合要求
4. 检查 JSON 格式是否正确

## 📊 示例数据

可以使用页面上的 "下载示例CSV" 或 "下载示例TSV" 按钮获取示例数据。

## 🔍 常见问题

### Q: 文件上传失败怎么办？
A: 检查文件大小是否超过 5MB，文件格式是否为 CSV/TSV。

### Q: 为什么某些用户导入失败？
A: 可能是邮箱或用户名重复，或者数据格式不正确。查看错误信息进行修正。

### Q: 如何处理中文用户名？
A: 系统支持中文用户名，确保文件编码为 UTF-8。

### Q: 可以导入多少用户？
A: 理论上没有限制，但建议使用批次处理来处理大量数据。

## 🛠️ 技术支持

如果遇到问题，请检查：

1. HydroOJ 服务是否正常运行
2. 插件是否正确安装
3. 用户权限是否足够
4. 浏览器控制台是否有错误信息

## 📈 性能建议

- 使用现代浏览器（Chrome、Firefox、Edge）
- 对于大量数据，建议分批导入
- 确保服务器有足够的内存和处理能力
- 在低峰时段进行大批量导入

---

如有问题或建议，请查看 [README.md](./README.md) 或联系开发团队。 