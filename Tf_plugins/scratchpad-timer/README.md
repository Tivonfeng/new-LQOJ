# 解题时间记录插件

## 功能介绍

解题时间记录插件是一个为 HydroOJ 设计的完整解题时长统计系统，能够自动记录学生从打开题目到AC的完整解题时间，并保存到后端数据库中。

## 主要功能

- **全程计时**：从打开题目页面开始自动计时
- **AC检测**：自动监听提交状态，检测到AC时停止计时
- **后端保存**：将完整的解题时间记录保存到数据库
- **状态恢复**：页面刷新后继续计时，不会重置
- **美观界面**：右上角显示实时解题时间
- **主题适配**：支持明暗主题切换

## 工作流程

1. **开始**：学生打开题目页面，计时器自动出现并开始计时
2. **计时**：显示"解题中..."状态，实时更新解题时间
3. **完成**：检测到AC提交时，自动停止计时
4. **保存**：将解题时间保存到后端数据库
5. **提示**：显示"解题时间已记录！"成功提示

## 安装方法

1. 将插件文件夹复制到 `Tf_plugins/scratchpad-timer/`
2. 重启 HydroOJ 服务
3. 插件将自动加载并在题目页面显示计时器

## 界面说明

- **位置**：页面右上角固定显示
- **状态**：
  - 🟡 解题中... (计时进行中)
  - 🟢 已完成！(已AC并保存记录)
- **隐藏**：在scratchpad模式下自动隐藏

## 数据存储

### 前端存储
- 使用localStorage保存当前计时状态
- 按题目ID独立存储，避免相互干扰
- AC完成后自动清除临时数据

### 后端存储
- 保存到数据库collection: `problem_solve_time`
- 记录字段：
  - `domainId`: 域ID
  - `uid`: 用户ID  
  - `pid`: 题目ID
  - `solveTime`: 解题耗时(毫秒)
  - `finishedAt`: 完成时间

## API接口

### POST /problem/:pid/timer
保存解题时间记录

**请求参数:**
```json
{
  "pid": "题目ID",
  "time": 解题时间毫秒数
}
```

**响应:**
```json
{
  "success": true
}
```

## 技术特性

- 使用 TypeScript 开发
- WebSocket 实时监听AC状态
- RESTful API 保存数据到后端
- 响应式设计，支持各种屏幕尺寸
- 完整的错误处理和用户反馈
- 与现有系统完全兼容，无冲突

## 使用场景

- **教学统计**：教师可查看学生解题时间分布
- **学习分析**：了解不同题目的平均解题时长
- **进度追踪**：监控学生编程能力提升情况
- **数据分析**：为教学决策提供数据支持 