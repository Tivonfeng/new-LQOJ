{% set page_name = "dice_game" %}
{% extends "layout/basic.html" %}
{% block content %}

<!-- React App Mount Point -->
<div id="dice-game-react-app"></div>

<!-- Pass data to React component via global variables -->
<script>
    // 将模板数据传递给React组件
    window.diceGameData = {
        currentCoins: {{ currentCoins or 0 }},
        canPlay: {{ 'true' if canPlay else 'false' }},
        availableBets: [
                        {% for bet in availableBets %}
            {{ bet }}{% if not loop.last %},{% endif %}
                        {% endfor %}
        ],
        gameConfig: {
            winMultiplier: {{ gameConfig.winMultiplier }},
            availableBets: [
                {% for bet in gameConfig.availableBets %}
                {{ bet }}{% if not loop.last %},{% endif %}
                {% endfor %}
            ]
        },
        userStats: {
            totalGames: {{ userStats.totalGames or 0 }},
            totalWins: {{ userStats.totalWins or 0 }},
            netProfit: {{ userStats.netProfit or 0 }},
            winStreak: {{ userStats.winStreak or 0 }},
            maxWinStreak: {{ userStats.maxWinStreak or 0 }}
        },
        winRate: '{{ winRate }}',
        recentGames: [
            {% for game in recentGames %}
            {
                diceValue: {{ game.diceValue }},
                guess: '{{ game.guess }}',
                won: {{ 'true' if game.won else 'false' }},
                netGain: {{ game.netGain }},
                gameTime: '{{ game.gameTime }}'
            }{% if not loop.last %},{% endif %}
            {% endfor %}
        ],
        dailyLimit: {
            remainingPlays: {{ dailyLimit.remainingPlays }},
            maxPlays: {{ dailyLimit.maxPlays }}
        }
    };

    // 传递URL
    window.dicePlayUrl = '{{ url("dice_play") }}';
    window.diceStatusUrl = '{{ url("dice_status") }}';
    window.scoreHallUrl = '{{ url("score_hall") }}';
    window.diceHistoryUrl = '{{ url("dice_history") }}';
</script>

{% endblock %}
